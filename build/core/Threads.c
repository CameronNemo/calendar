/* Threads.c generated by valac 0.24.0, the Vala compiler
 * generated from Threads.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: nil; tab-width: 4 -*-*/
/*-
 * Copyright (c) 2013 Maya Developers (https://launchpad.net/maya)
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Library General Public
 * License as published by the Free Software Foundation; either
 * version 2 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Library General Public License for more details.
 *
 * You should have received a copy of the GNU Library General Public
 * License along with this library; if not, write to the
 * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 * Boston, MA 02111-1307, USA.
 */

#include <glib.h>
#include <glib-object.h>
#include <gobject/gvaluecollector.h>


#define MAYA_TYPE_THREADS (maya_threads_get_type ())
#define MAYA_THREADS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAYA_TYPE_THREADS, MayaThreads))
#define MAYA_THREADS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAYA_TYPE_THREADS, MayaThreadsClass))
#define MAYA_IS_THREADS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAYA_TYPE_THREADS))
#define MAYA_IS_THREADS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAYA_TYPE_THREADS))
#define MAYA_THREADS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAYA_TYPE_THREADS, MayaThreadsClass))

typedef struct _MayaThreads MayaThreads;
typedef struct _MayaThreadsClass MayaThreadsClass;
typedef struct _MayaThreadsPrivate MayaThreadsPrivate;

#define MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER (maya_threads_task_func_wrapper_get_type ())
#define MAYA_THREADS_TASK_FUNC_WRAPPER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapper))
#define MAYA_THREADS_TASK_FUNC_WRAPPER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapperClass))
#define MAYA_THREADS_IS_TASK_FUNC_WRAPPER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER))
#define MAYA_THREADS_IS_TASK_FUNC_WRAPPER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER))
#define MAYA_THREADS_TASK_FUNC_WRAPPER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapperClass))

typedef struct _MayaThreadsTaskFuncWrapper MayaThreadsTaskFuncWrapper;
typedef struct _MayaThreadsTaskFuncWrapperClass MayaThreadsTaskFuncWrapperClass;
#define _g_thread_pool_free0(var) ((var == NULL) ? NULL : (var = (g_thread_pool_free (var, FALSE, TRUE), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _maya_threads_unref0(var) ((var == NULL) ? NULL : (var = (maya_threads_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
typedef struct _MayaThreadsTaskFuncWrapperPrivate MayaThreadsTaskFuncWrapperPrivate;
typedef struct _MayaParamSpecThreads MayaParamSpecThreads;
#define _vala_assert(expr, msg) if G_LIKELY (expr) ; else g_assertion_message_expr (G_LOG_DOMAIN, __FILE__, __LINE__, G_STRFUNC, msg);

struct _MayaThreads {
	GTypeInstance parent_instance;
	volatile int ref_count;
	MayaThreadsPrivate * priv;
};

struct _MayaThreadsClass {
	GTypeClass parent_class;
	void (*finalize) (MayaThreads *self);
};

struct _MayaThreadsPrivate {
	GThreadPool* thread_pool;
	GRecMutex __lock_thread_pool;
};

typedef void (*MayaThreadsTaskFunc) (void* user_data);
struct _MayaThreadsTaskFuncWrapper {
	GObject parent_instance;
	MayaThreadsTaskFuncWrapperPrivate * priv;
};

struct _MayaThreadsTaskFuncWrapperClass {
	GObjectClass parent_class;
};

struct _MayaThreadsTaskFuncWrapperPrivate {
	MayaThreadsTaskFunc _func;
	gpointer _func_target;
	guint _id;
};

struct _MayaParamSpecThreads {
	GParamSpec parent_instance;
};


static gpointer maya_threads_parent_class = NULL;
static MayaThreads* maya_threads_instance;
static GRecMutex __lock_maya_threads_instance = {0};
static MayaThreads* maya_threads_instance = NULL;
static gpointer maya_threads_task_func_wrapper_parent_class = NULL;
static guint maya_threads_task_func_wrapper_count;
static GRecMutex __lock_maya_threads_task_func_wrapper_count = {0};
static guint maya_threads_task_func_wrapper_count = (guint) 0;

gpointer maya_threads_ref (gpointer instance);
void maya_threads_unref (gpointer instance);
GParamSpec* maya_param_spec_threads (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void maya_value_set_threads (GValue* value, gpointer v_object);
void maya_value_take_threads (GValue* value, gpointer v_object);
gpointer maya_value_get_threads (const GValue* value);
GType maya_threads_get_type (void) G_GNUC_CONST;
static GType maya_threads_task_func_wrapper_get_type (void) G_GNUC_CONST G_GNUC_UNUSED;
#define MAYA_THREADS_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), MAYA_TYPE_THREADS, MayaThreadsPrivate))
enum  {
	MAYA_THREADS_DUMMY_PROPERTY
};
#define MAYA_THREADS_MAX_THREADS (-1)
#define MAYA_THREADS_MAX_UNUSED_THREADS 5
static MayaThreads* maya_threads_new (void);
static MayaThreads* maya_threads_construct (GType object_type);
static void maya_threads_task_func (MayaThreads* self, MayaThreadsTaskFuncWrapper* wrapper);
static void _maya_threads_task_func_gfunc (gpointer data, gpointer self);
gboolean maya_threads_add (MayaThreadsTaskFunc task, void* task_target);
static void maya_threads_push_task (MayaThreads* self, MayaThreadsTaskFunc task, void* task_target, GError** error);
static MayaThreadsTaskFuncWrapper* maya_threads_task_func_wrapper_new (MayaThreadsTaskFunc func, void* func_target);
static MayaThreadsTaskFuncWrapper* maya_threads_task_func_wrapper_construct (GType object_type, MayaThreadsTaskFunc func, void* func_target);
static guint maya_threads_task_func_wrapper_get_id (MayaThreadsTaskFuncWrapper* self);
static MayaThreadsTaskFunc maya_threads_task_func_wrapper_get_func (MayaThreadsTaskFuncWrapper* self, gpointer* result_target);
#define MAYA_THREADS_TASK_FUNC_WRAPPER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapperPrivate))
enum  {
	MAYA_THREADS_TASK_FUNC_WRAPPER_DUMMY_PROPERTY,
	MAYA_THREADS_TASK_FUNC_WRAPPER_ID
};
static void maya_threads_task_func_wrapper_set_id (MayaThreadsTaskFuncWrapper* self, guint value);
static void maya_threads_task_func_wrapper_set_func (MayaThreadsTaskFuncWrapper* self, MayaThreadsTaskFunc value, gpointer value_target);
static void maya_threads_task_func_wrapper_finalize (GObject* obj);
static void _vala_maya_threads_task_func_wrapper_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_maya_threads_task_func_wrapper_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static void maya_threads_finalize (MayaThreads* obj);


static void _maya_threads_task_func_gfunc (gpointer data, gpointer self) {
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	maya_threads_task_func ((MayaThreads*) self, (MayaThreadsTaskFuncWrapper*) data);
#line 144 "Threads.c"
}


static MayaThreads* maya_threads_construct (GType object_type) {
	MayaThreads* self = NULL;
	MayaThreads* _tmp0_ = NULL;
	GError * _inner_error_ = NULL;
#line 74 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self = (MayaThreads*) g_type_create_instance (object_type);
#line 75 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = maya_threads_instance;
#line 75 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_vala_assert (_tmp0_ == NULL, "instance == null");
#line 158 "Threads.c"
	{
		GThreadPool* _tmp1_ = NULL;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp1_ = self->priv->thread_pool;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_rec_mutex_lock (&self->priv->__lock_thread_pool);
#line 165 "Threads.c"
		{
			{
				GThreadPool* _tmp2_ = NULL;
				GThreadPool* _tmp3_ = NULL;
				GThreadPool* _tmp4_ = NULL;
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp3_ = g_thread_pool_new (_maya_threads_task_func_gfunc, self, MAYA_THREADS_MAX_THREADS, MAYA_THREADS_MAX_THREADS > 0, &_inner_error_);
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp2_ = _tmp3_;
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				if (_inner_error_ != NULL) {
#line 177 "Threads.c"
					goto __catch22_g_error;
				}
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp4_ = _tmp2_;
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp2_ = NULL;
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_g_thread_pool_free0 (self->priv->thread_pool);
#line 79 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				self->priv->thread_pool = _tmp4_;
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_g_thread_pool_free0 (_tmp2_);
#line 190 "Threads.c"
			}
			goto __finally22;
			__catch22_g_error:
			{
				GError* err = NULL;
				const gchar* _tmp5_ = NULL;
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				err = _inner_error_;
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_inner_error_ = NULL;
#line 84 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp5_ = err->message;
#line 84 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				g_error ("Threads.vala:84: Couldn't create default thread pool: %s", _tmp5_);
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_g_error_free0 (err);
#line 207 "Threads.c"
			}
			__finally22:
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			if (_inner_error_ != NULL) {
#line 212 "Threads.c"
				{
					GThreadPool* _tmp6_ = NULL;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
					_tmp6_ = self->priv->thread_pool;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
					g_rec_mutex_unlock (&self->priv->__lock_thread_pool);
#line 219 "Threads.c"
				}
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				g_clear_error (&_inner_error_);
#line 78 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				return NULL;
#line 227 "Threads.c"
			}
#line 87 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_thread_pool_set_max_unused_threads (MAYA_THREADS_MAX_UNUSED_THREADS);
#line 231 "Threads.c"
		}
		__finally21:
		{
			GThreadPool* _tmp7_ = NULL;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp7_ = self->priv->thread_pool;
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_rec_mutex_unlock (&self->priv->__lock_thread_pool);
#line 240 "Threads.c"
		}
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (_inner_error_ != NULL) {
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_clear_error (&_inner_error_);
#line 77 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return NULL;
#line 250 "Threads.c"
		}
	}
#line 74 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return self;
#line 255 "Threads.c"
}


static MayaThreads* maya_threads_new (void) {
#line 74 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return maya_threads_construct (MAYA_TYPE_THREADS);
#line 262 "Threads.c"
}


/**
     * Adds //task// to be processed on a separate thread. The task function is not
     * owned by the method and should be kept alive by the owner until it is actually
     * called from a different thread.
     */
gboolean maya_threads_add (MayaThreadsTaskFunc task, void* task_target) {
	gboolean result = FALSE;
	GError * _inner_error_ = NULL;
	{
		MayaThreads* _tmp0_ = NULL;
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp0_ = maya_threads_instance;
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_rec_mutex_lock (&__lock_maya_threads_instance);
#line 280 "Threads.c"
		{
			MayaThreads* _tmp1_ = NULL;
#line 98 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp1_ = maya_threads_instance;
#line 98 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			if (_tmp1_ == NULL) {
#line 287 "Threads.c"
				MayaThreads* _tmp2_ = NULL;
#line 99 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_tmp2_ = maya_threads_new ();
#line 99 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_maya_threads_unref0 (maya_threads_instance);
#line 99 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				maya_threads_instance = _tmp2_;
#line 295 "Threads.c"
			}
		}
		__finally23:
		{
			MayaThreads* _tmp3_ = NULL;
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp3_ = maya_threads_instance;
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_rec_mutex_unlock (&__lock_maya_threads_instance);
#line 305 "Threads.c"
		}
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (_inner_error_ != NULL) {
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_clear_error (&_inner_error_);
#line 97 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return FALSE;
#line 315 "Threads.c"
		}
	}
	{
		MayaThreads* _tmp4_ = NULL;
		MayaThreadsTaskFunc _tmp5_ = NULL;
		void* _tmp5__target = NULL;
#line 103 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp4_ = maya_threads_instance;
#line 103 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp5_ = task;
#line 103 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp5__target = task_target;
#line 103 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_push_task (_tmp4_, _tmp5_, _tmp5__target, &_inner_error_);
#line 103 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (_inner_error_ != NULL) {
#line 332 "Threads.c"
			goto __catch24_g_error;
		}
	}
	goto __finally24;
	__catch24_g_error:
	{
		GError* err = NULL;
		GError* _tmp6_ = NULL;
		const gchar* _tmp7_ = NULL;
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		err = _inner_error_;
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_inner_error_ = NULL;
#line 105 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp6_ = err;
#line 105 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp7_ = _tmp6_->message;
#line 105 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_critical ("Threads.vala:105: Could not add task: %s", _tmp7_);
#line 106 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		result = FALSE;
#line 106 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_g_error_free0 (err);
#line 106 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		return result;
#line 358 "Threads.c"
	}
	__finally24:
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (_inner_error_ != NULL) {
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_clear_error (&_inner_error_);
#line 102 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		return FALSE;
#line 369 "Threads.c"
	}
#line 109 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	result = TRUE;
#line 109 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return result;
#line 375 "Threads.c"
}


/**
     * Pushes //task// into the thread pool.
     * @see Maya.Threads.add
     */
static void maya_threads_push_task (MayaThreads* self, MayaThreadsTaskFunc task, void* task_target, GError** error) {
	GError * _inner_error_ = NULL;
#line 116 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (self != NULL);
#line 387 "Threads.c"
	{
		GThreadPool* _tmp0_ = NULL;
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp0_ = self->priv->thread_pool;
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_rec_mutex_lock (&self->priv->__lock_thread_pool);
#line 394 "Threads.c"
		{
			MayaThreadsTaskFuncWrapper* wrapper = NULL;
			MayaThreadsTaskFunc _tmp1_ = NULL;
			void* _tmp1__target = NULL;
			MayaThreadsTaskFuncWrapper* _tmp2_ = NULL;
			GThreadPool* _tmp3_ = NULL;
			MayaThreadsTaskFuncWrapper* _tmp4_ = NULL;
#line 118 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp1_ = task;
#line 118 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp1__target = task_target;
#line 118 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp2_ = maya_threads_task_func_wrapper_new (_tmp1_, _tmp1__target);
#line 118 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			wrapper = _tmp2_;
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp3_ = self->priv->thread_pool;
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp4_ = wrapper;
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			wrapper = NULL;
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_thread_pool_push (_tmp3_, _tmp4_, &_inner_error_);
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			if (_inner_error_ != NULL) {
#line 119 "/home/phillip/maya/fix-1329550/core/Threads.vala"
				_g_object_unref0 (wrapper);
#line 422 "Threads.c"
				goto __finally25;
			}
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_g_object_unref0 (wrapper);
#line 427 "Threads.c"
		}
		__finally25:
		{
			GThreadPool* _tmp5_ = NULL;
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp5_ = self->priv->thread_pool;
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_rec_mutex_unlock (&self->priv->__lock_thread_pool);
#line 436 "Threads.c"
		}
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (_inner_error_ != NULL) {
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_propagate_error (error, _inner_error_);
#line 117 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return;
#line 444 "Threads.c"
		}
	}
}


/**
     * Called by the thread pool right after preparing a thread. The method is
     * responsible for executing the actual task function.
     */
static void maya_threads_task_func (MayaThreads* self, MayaThreadsTaskFuncWrapper* wrapper) {
	guint id = 0U;
	MayaThreadsTaskFuncWrapper* _tmp0_ = NULL;
	guint _tmp1_ = 0U;
	guint _tmp2_ = 0U;
	guint _tmp3_ = 0U;
	MayaThreadsTaskFuncWrapper* _tmp4_ = NULL;
	MayaThreadsTaskFunc _tmp5_ = NULL;
	void* _tmp5__target = NULL;
	MayaThreadsTaskFunc _tmp6_ = NULL;
	void* _tmp6__target = NULL;
#line 127 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (self != NULL);
#line 127 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (wrapper != NULL);
#line 128 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = wrapper;
#line 128 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp1_ = maya_threads_task_func_wrapper_get_id (_tmp0_);
#line 128 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp2_ = _tmp1_;
#line 128 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	id = _tmp2_;
#line 129 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp3_ = id;
#line 129 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_debug ("Threads.vala:129: -- Dispatching task [%u]", _tmp3_);
#line 131 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp4_ = wrapper;
#line 131 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp5_ = maya_threads_task_func_wrapper_get_func (_tmp4_, &_tmp5__target);
#line 131 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp6_ = _tmp5_;
#line 131 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp6__target = _tmp5__target;
#line 131 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (_tmp6_ != NULL) {
#line 491 "Threads.c"
		guint _tmp7_ = 0U;
		MayaThreadsTaskFuncWrapper* _tmp8_ = NULL;
		MayaThreadsTaskFunc _tmp9_ = NULL;
		void* _tmp9__target = NULL;
		MayaThreadsTaskFunc _tmp10_ = NULL;
		void* _tmp10__target = NULL;
		guint _tmp11_ = 0U;
#line 132 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp7_ = id;
#line 132 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_debug ("Threads.vala:132: -- starting [%u]", _tmp7_);
#line 133 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp8_ = wrapper;
#line 133 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp9_ = maya_threads_task_func_wrapper_get_func (_tmp8_, &_tmp9__target);
#line 133 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp10_ = _tmp9_;
#line 133 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp10__target = _tmp9__target;
#line 133 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp10_ (_tmp10__target);
#line 134 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp11_ = id;
#line 134 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_debug ("Threads.vala:134: -- finished [%u]", _tmp11_);
#line 517 "Threads.c"
	}
#line 127 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_g_object_unref0 (wrapper);
#line 521 "Threads.c"
}


static MayaThreadsTaskFuncWrapper* maya_threads_task_func_wrapper_construct (GType object_type, MayaThreadsTaskFunc func, void* func_target) {
	MayaThreadsTaskFuncWrapper * self = NULL;
	guint _tmp3_ = 0U;
	MayaThreadsTaskFunc _tmp4_ = NULL;
	void* _tmp4__target = NULL;
	GError * _inner_error_ = NULL;
#line 47 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self = (MayaThreadsTaskFuncWrapper*) g_object_new (object_type, NULL);
#line 533 "Threads.c"
	{
		guint _tmp0_ = 0U;
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		_tmp0_ = maya_threads_task_func_wrapper_count;
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_rec_mutex_lock (&__lock_maya_threads_task_func_wrapper_count);
#line 540 "Threads.c"
		{
			guint _tmp1_ = 0U;
#line 49 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp1_ = maya_threads_task_func_wrapper_count;
#line 49 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			maya_threads_task_func_wrapper_count = _tmp1_ + 1;
#line 49 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			maya_threads_task_func_wrapper_set_id (self, _tmp1_);
#line 549 "Threads.c"
		}
		__finally26:
		{
			guint _tmp2_ = 0U;
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			_tmp2_ = maya_threads_task_func_wrapper_count;
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_rec_mutex_unlock (&__lock_maya_threads_task_func_wrapper_count);
#line 558 "Threads.c"
		}
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (_inner_error_ != NULL) {
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			g_clear_error (&_inner_error_);
#line 48 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return NULL;
#line 568 "Threads.c"
		}
	}
#line 51 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp3_ = self->priv->_id;
#line 51 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_debug ("Threads.vala:51: Creating task [%u]", _tmp3_);
#line 52 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp4_ = func;
#line 52 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp4__target = func_target;
#line 52 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	maya_threads_task_func_wrapper_set_func (self, _tmp4_, _tmp4__target);
#line 47 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return self;
#line 583 "Threads.c"
}


static MayaThreadsTaskFuncWrapper* maya_threads_task_func_wrapper_new (MayaThreadsTaskFunc func, void* func_target) {
#line 47 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return maya_threads_task_func_wrapper_construct (MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, func, func_target);
#line 590 "Threads.c"
}


static MayaThreadsTaskFunc maya_threads_task_func_wrapper_get_func (MayaThreadsTaskFuncWrapper* self, gpointer* result_target) {
	MayaThreadsTaskFunc result;
	MayaThreadsTaskFunc _tmp0_ = NULL;
	void* _tmp0__target = NULL;
	MayaThreadsTaskFunc _tmp1_ = NULL;
	void* _tmp1__target = NULL;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = self->priv->_func;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0__target = self->priv->_func_target;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp1_ = _tmp0_;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp1__target = _tmp0__target;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	*result_target = _tmp1__target;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	result = _tmp1_;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return result;
#line 616 "Threads.c"
}


static void maya_threads_task_func_wrapper_set_func (MayaThreadsTaskFuncWrapper* self, MayaThreadsTaskFunc value, gpointer value_target) {
	MayaThreadsTaskFunc _tmp0_ = NULL;
	void* _tmp0__target = NULL;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (self != NULL);
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = value;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0__target = value_target;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->priv->_func = _tmp0_;
#line 43 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->priv->_func_target = _tmp0__target;
#line 633 "Threads.c"
}


static guint maya_threads_task_func_wrapper_get_id (MayaThreadsTaskFuncWrapper* self) {
	guint result;
	guint _tmp0_ = 0U;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_val_if_fail (self != NULL, 0U);
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = self->priv->_id;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	result = _tmp0_;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return result;
#line 648 "Threads.c"
}


static void maya_threads_task_func_wrapper_set_id (MayaThreadsTaskFuncWrapper* self, guint value) {
	guint _tmp0_ = 0U;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (self != NULL);
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = value;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->priv->_id = _tmp0_;
#line 44 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_object_notify ((GObject *) self, "id");
#line 662 "Threads.c"
}


static void maya_threads_task_func_wrapper_class_init (MayaThreadsTaskFuncWrapperClass * klass) {
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	maya_threads_task_func_wrapper_parent_class = g_type_class_peek_parent (klass);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_type_class_add_private (klass, sizeof (MayaThreadsTaskFuncWrapperPrivate));
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_maya_threads_task_func_wrapper_get_property;
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_maya_threads_task_func_wrapper_set_property;
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	G_OBJECT_CLASS (klass)->finalize = maya_threads_task_func_wrapper_finalize;
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), MAYA_THREADS_TASK_FUNC_WRAPPER_ID, g_param_spec_uint ("id", "id", "id", 0, G_MAXUINT, 0U, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
#line 45 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_rec_mutex_init (&__lock_maya_threads_task_func_wrapper_count);
#line 681 "Threads.c"
}


static void maya_threads_task_func_wrapper_instance_init (MayaThreadsTaskFuncWrapper * self) {
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->priv = MAYA_THREADS_TASK_FUNC_WRAPPER_GET_PRIVATE (self);
#line 688 "Threads.c"
}


static void maya_threads_task_func_wrapper_finalize (GObject* obj) {
	MayaThreadsTaskFuncWrapper * self;
	guint _tmp0_ = 0U;
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapper);
#line 56 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_tmp0_ = self->priv->_id;
#line 56 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_debug ("Threads.vala:56: ~Destroying task [%u]", _tmp0_);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	G_OBJECT_CLASS (maya_threads_task_func_wrapper_parent_class)->finalize (obj);
#line 703 "Threads.c"
}


/**
     * An object that wraps a TaskFunc delegate.
     *
     * We need this class because delegates with targets cannot be pushed directly into
     * a thread pool, nor used as generic type arguments. This doesn't mean the class is
     * merely a workaround though. Its existence has the bonus of allowing easy tracking
     * of task creation/destruction, and the internal counter exposes the number of tasks
     * that have been processed during the entire execution time of the application.
     */
static GType maya_threads_task_func_wrapper_get_type (void) {
	static volatile gsize maya_threads_task_func_wrapper_type_id__volatile = 0;
	if (g_once_init_enter (&maya_threads_task_func_wrapper_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (MayaThreadsTaskFuncWrapperClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) maya_threads_task_func_wrapper_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MayaThreadsTaskFuncWrapper), 0, (GInstanceInitFunc) maya_threads_task_func_wrapper_instance_init, NULL };
		GType maya_threads_task_func_wrapper_type_id;
		maya_threads_task_func_wrapper_type_id = g_type_register_static (G_TYPE_OBJECT, "MayaThreadsTaskFuncWrapper", &g_define_type_info, 0);
		g_once_init_leave (&maya_threads_task_func_wrapper_type_id__volatile, maya_threads_task_func_wrapper_type_id);
	}
	return maya_threads_task_func_wrapper_type_id__volatile;
}


static void _vala_maya_threads_task_func_wrapper_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	MayaThreadsTaskFuncWrapper * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapper);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	switch (property_id) {
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		case MAYA_THREADS_TASK_FUNC_WRAPPER_ID:
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_value_set_uint (value, maya_threads_task_func_wrapper_get_id (self));
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		break;
#line 739 "Threads.c"
		default:
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		break;
#line 745 "Threads.c"
	}
}


static void _vala_maya_threads_task_func_wrapper_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	MayaThreadsTaskFuncWrapper * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, MAYA_THREADS_TYPE_TASK_FUNC_WRAPPER, MayaThreadsTaskFuncWrapper);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	switch (property_id) {
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		case MAYA_THREADS_TASK_FUNC_WRAPPER_ID:
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_task_func_wrapper_set_id (self, g_value_get_uint (value));
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		break;
#line 761 "Threads.c"
		default:
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 42 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		break;
#line 767 "Threads.c"
	}
}


static void maya_value_threads_init (GValue* value) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	value->data[0].v_pointer = NULL;
#line 775 "Threads.c"
}


static void maya_value_threads_free_value (GValue* value) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (value->data[0].v_pointer) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_unref (value->data[0].v_pointer);
#line 784 "Threads.c"
	}
}


static void maya_value_threads_copy_value (const GValue* src_value, GValue* dest_value) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (src_value->data[0].v_pointer) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		dest_value->data[0].v_pointer = maya_threads_ref (src_value->data[0].v_pointer);
#line 794 "Threads.c"
	} else {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		dest_value->data[0].v_pointer = NULL;
#line 798 "Threads.c"
	}
}


static gpointer maya_value_threads_peek_pointer (const GValue* value) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return value->data[0].v_pointer;
#line 806 "Threads.c"
}


static gchar* maya_value_threads_collect_value (GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (collect_values[0].v_pointer) {
#line 813 "Threads.c"
		MayaThreads* object;
		object = collect_values[0].v_pointer;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		if (object->parent_instance.g_class == NULL) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 820 "Threads.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 824 "Threads.c"
		}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = maya_threads_ref (object);
#line 828 "Threads.c"
	} else {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = NULL;
#line 832 "Threads.c"
	}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return NULL;
#line 836 "Threads.c"
}


static gchar* maya_value_threads_lcopy_value (const GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
	MayaThreads** object_p;
	object_p = collect_values[0].v_pointer;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (!object_p) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 847 "Threads.c"
	}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (!value->data[0].v_pointer) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		*object_p = NULL;
#line 853 "Threads.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		*object_p = value->data[0].v_pointer;
#line 857 "Threads.c"
	} else {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		*object_p = maya_threads_ref (value->data[0].v_pointer);
#line 861 "Threads.c"
	}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return NULL;
#line 865 "Threads.c"
}


GParamSpec* maya_param_spec_threads (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags) {
	MayaParamSpecThreads* spec;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_val_if_fail (g_type_is_a (object_type, MAYA_TYPE_THREADS), NULL);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return G_PARAM_SPEC (spec);
#line 879 "Threads.c"
}


gpointer maya_value_get_threads (const GValue* value) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MAYA_TYPE_THREADS), NULL);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return value->data[0].v_pointer;
#line 888 "Threads.c"
}


void maya_value_set_threads (GValue* value, gpointer v_object) {
	MayaThreads* old;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MAYA_TYPE_THREADS));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	old = value->data[0].v_pointer;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (v_object) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, MAYA_TYPE_THREADS));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = v_object;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_ref (value->data[0].v_pointer);
#line 908 "Threads.c"
	} else {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = NULL;
#line 912 "Threads.c"
	}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (old) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_unref (old);
#line 918 "Threads.c"
	}
}


void maya_value_take_threads (GValue* value, gpointer v_object) {
	MayaThreads* old;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MAYA_TYPE_THREADS));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	old = value->data[0].v_pointer;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (v_object) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, MAYA_TYPE_THREADS));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = v_object;
#line 937 "Threads.c"
	} else {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		value->data[0].v_pointer = NULL;
#line 941 "Threads.c"
	}
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (old) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		maya_threads_unref (old);
#line 947 "Threads.c"
	}
}


static void maya_threads_class_init (MayaThreadsClass * klass) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	maya_threads_parent_class = g_type_class_peek_parent (klass);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	MAYA_THREADS_CLASS (klass)->finalize = maya_threads_finalize;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_type_class_add_private (klass, sizeof (MayaThreadsPrivate));
#line 71 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_rec_mutex_init (&__lock_maya_threads_instance);
#line 961 "Threads.c"
}


static void maya_threads_instance_init (MayaThreads * self) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->priv = MAYA_THREADS_GET_PRIVATE (self);
#line 70 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_rec_mutex_init (&self->priv->__lock_thread_pool);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self->ref_count = 1;
#line 972 "Threads.c"
}


static void maya_threads_finalize (MayaThreads* obj) {
	MayaThreads * self;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAYA_TYPE_THREADS, MayaThreads);
#line 70 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_rec_mutex_clear (&self->priv->__lock_thread_pool);
#line 70 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	_g_thread_pool_free0 (self->priv->thread_pool);
#line 984 "Threads.c"
}


/**
 * A central place for spawning threads.
 *
 * The main purpose of this class is to have a central place to track and control all the
 * threads created by the application, in a thread-safe environment. Second, but not less
 * important, is the ability to re-use existing threads in order to minimize the overhead
 * generated by the creation/destruction of new threads under certain conditions.
 */
GType maya_threads_get_type (void) {
	static volatile gsize maya_threads_type_id__volatile = 0;
	if (g_once_init_enter (&maya_threads_type_id__volatile)) {
		static const GTypeValueTable g_define_type_value_table = { maya_value_threads_init, maya_value_threads_free_value, maya_value_threads_copy_value, maya_value_threads_peek_pointer, "p", maya_value_threads_collect_value, "p", maya_value_threads_lcopy_value };
		static const GTypeInfo g_define_type_info = { sizeof (MayaThreadsClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) maya_threads_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MayaThreads), 0, (GInstanceInitFunc) maya_threads_instance_init, &g_define_type_value_table };
		static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
		GType maya_threads_type_id;
		maya_threads_type_id = g_type_register_fundamental (g_type_fundamental_next (), "MayaThreads", &g_define_type_info, &g_define_type_fundamental_info, 0);
		g_once_init_leave (&maya_threads_type_id__volatile, maya_threads_type_id);
	}
	return maya_threads_type_id__volatile;
}


gpointer maya_threads_ref (gpointer instance) {
	MayaThreads* self;
	self = instance;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	g_atomic_int_inc (&self->ref_count);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	return instance;
#line 1017 "Threads.c"
}


void maya_threads_unref (gpointer instance) {
	MayaThreads* self;
	self = instance;
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		MAYA_THREADS_GET_CLASS (self)->finalize (self);
#line 29 "/home/phillip/maya/fix-1329550/core/Threads.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 1030 "Threads.c"
	}
}



